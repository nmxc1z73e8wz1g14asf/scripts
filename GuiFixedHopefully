local Players = game:GetService("Players")
local player = Players.LocalPlayer
local UIS = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

-- Remove old GUI
local old = CoreGui:FindFirstChild("UltraGUI")
if old then old:Destroy() end

-- Create GUI container
local screenGui = Instance.new("ScreenGui", CoreGui)
screenGui.Name = "UltraGUI"

local function roundCorner(inst, radius)
    local c = Instance.new("UICorner", inst)
    c.CornerRadius = UDim.new(0, radius or 8)
end

-- Main Frame
local main = Instance.new("Frame", screenGui)
main.Size = UDim2.new(0, 540, 0, 360)
main.Position = UDim2.new(0.5, -270, 0.5, -180)
main.AnchorPoint = Vector2.new(0.5, 0.5)
main.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
roundCorner(main, 12)

-- Draggable Title Bar
local titleBar = Instance.new("Frame", main)
titleBar.Size = UDim2.new(1, 0, 0, 40)
titleBar.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
roundCorner(titleBar, 12)

local titleLabel = Instance.new("TextLabel", titleBar)
titleLabel.Size = UDim2.new(1, -100, 1, 0)
titleLabel.Position = UDim2.new(0, 20, 0, 0)
titleLabel.BackgroundTransparency = 1
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 22
titleLabel.TextColor3 = Color3.fromRGB(230, 230, 230)
titleLabel.Text = "Ultragui"
titleLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Close Button
local closeBtn = Instance.new("TextButton", titleBar)
closeBtn.Size = UDim2.new(0, 40, 1, -10)
closeBtn.Position = UDim2.new(1, -50, 0, 5)
closeBtn.Text = "X"
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 18
closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
closeBtn.BackgroundColor3 = Color3.fromRGB(220, 50, 50)
roundCorner(closeBtn, 8)
closeBtn.MouseButton1Click:Connect(function() screenGui:Destroy() end)

-- Minimize Button
local minBtn = Instance.new("TextButton", titleBar)
minBtn.Size = UDim2.new(0, 40, 1, -10)
minBtn.Position = UDim2.new(1, -100, 0, 5)
minBtn.Text = "-"
minBtn.Font = Enum.Font.GothamBold
minBtn.TextSize = 24
minBtn.TextColor3 = Color3.fromRGB(255,255,255)
minBtn.BackgroundColor3 = Color3.fromRGB(120, 120, 120)
roundCorner(minBtn, 8)

-- Drag Logic
local dragging, dragStart, startPos
titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = main.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end)

titleBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        UIS.InputChanged:Connect(function(move)
            if dragging and move.UserInputType == Enum.UserInputType.MouseMovement then
                main.Position = UDim2.new(
                    startPos.X.Scale, startPos.X.Offset + (move.Position.X - dragStart.X),
                    startPos.Y.Scale, startPos.Y.Offset + (move.Position.Y - dragStart.Y)
                )
            end
        end)
    end
end)

-- Content Holder
local content = Instance.new("Frame", main)
content.Size = UDim2.new(1, -40, 1, -100)
content.Position = UDim2.new(0, 20, 0, 60)
content.BackgroundTransparency = 1

-- Buttons Creator
local function makeBtn(parent, txt, func)
    local b = Instance.new("TextButton", parent)
    b.Size = UDim2.new(0, 240, 0, 50)
    b.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    b.TextColor3 = Color3.fromRGB(230, 230, 230)
    b.Font = Enum.Font.Gotham
    b.TextSize = 18
    b.Text = txt
    roundCorner(b, 8)
    b.MouseButton1Click:Connect(func)
    return b
end

-- Character Scripts Column
local charCol = Instance.new("Frame", content)
charCol.Size = UDim2.new(0, 260, 1, 0)
charCol.BackgroundTransparency = 1
for i, txt in ipairs({"Speed", "High Jump", "Godmode", "Invisibility"}) do
    local y = 10 + (i-1)*60
    makeBtn(charCol, txt, function() end).Position = UDim2.new(0, 0, 0, y)
end

-- Teleports Column
local tpCol = Instance.new("Frame", content)
tpCol.Size = UDim2.new(0, 260, 1, 0)
tpCol.Position = UDim2.new(0, 280, 0, 0)
tpCol.BackgroundTransparency = 1
local coords = {
    {"Jungle Island", Vector3.new(-8393,53,2402)},
    {"Legend Island", Vector3.new(4524,1001,-3842)},
    {"Magma Island", Vector3.new(-6813,35,-1279)}
}
for i, item in ipairs(coords) do
    local y = 10 + (i-1)*60
    makeBtn(tpCol, item[1], function()
        local ch = player.Character or player.CharacterAdded:Wait()
        ch:WaitForChild("HumanoidRootPart").CFrame = CFrame.new(item[2])
    end).Position = UDim2.new(0, 0, 0, y)
end

-- Minimize Func
local isMin = false
minBtn.MouseButton1Click:Connect(function()
    isMin = not isMin
    if isMin then
        main.Size = UDim2.new(0, 540, 0, 40)
        content.Visible = false
    else
        main.Size = UDim2.new(0, 540, 0, 360)
        content.Visible = true
    end
end)

